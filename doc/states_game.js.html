<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: states/game.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: states/game.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code> /**
  * Etat jeu: &lt;br />
  * Gère la routine du jeu comme les projectiles.
  * @class Game
  */
var Game = {

	/**
	 * @constructor Game
	 */
	create: function () {
		
		var gameNumber = parseInt(localStorage.getItem("gameNumber"))+1;
		localStorage.setItem("gameNumber", gameNumber);
			
		game.physics.startSystem(Phaser.Physics.ARCADE);

		player = [];
		interactionsBox = [];
		projectiles = [];

		// ====
		// on créer les platforms
		var map = new LevelCreator(selectedMap);
		map.create();

		// on décode les fichiers audio .mp3
		footstep = game.add.audio('footstep');
		jump = game.add.audio('jump');
		tackle = game.add.audio('tackle');

		// RETURN BUTTON
		var retour = game.add.button(0, 0, 'return', loadMainMenu, this, 2, 1, 0);
		var text = game.add.bitmapText(40, 40, 'pixel', '&lt;', 32);

		// ====
		// On créer les joueurs
		for (var i=0; i &lt; playerMeta.length; i++)
			if (playerMeta[i].enable)
				player.push(new Player(width * Math.random(), convertY(82.8), playerMeta[i].id, playerMeta[i].tint));

	},

	update: function () {

		// retour menu
		if (game.input.keyboard.addKey(Phaser.Keyboard.ESC).isDown)
			loadMainMenu();

		for (var i=0; i &lt; player.flength; i++)
			player[i].update(platforms);
		
		for (var i=0; i &lt; projectiles.length; i++) {
			
			// la fonction update renvoie true quand le projectile a touché un truc
			// si elle renvoie true, alors on supprime le projectile
			if (projectiles[i].update()) {
				projectiles[i].destroy();
				projectiles.splice(i, i+1);					
			}
		}

		// ====
		// SCORE SYSTEM
		var playersAlive = [];

		for (var i=0; i &lt; player.length; i++)
			if (player[i].hp > 0)
				playersAlive.push(player[i]);

		if (playersAlive.length == 1) {
			var idWinner = playersAlive[0].id;

			playerMeta[idWinner].score++;
			console.log("notre gagnant est " + playerMeta[idWinner].name);
			
			game.state.add('Score', Score);
			game.state.start('Score');
		}
	},

	/*render: function() {
		// on affiche les collisions box des joueurs
		for (var i=0; i &lt; player.length; i++)
			if (player[i].hp > 0)
				game.debug.body(player[i].player);
	}//*/
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BootStrap.html">BootStrap</a></li><li><a href="Credits.html">Credits</a></li><li><a href="FloatingText.html">FloatingText</a></li><li><a href="Game.html">Game</a></li><li><a href="InteractionBox.html">InteractionBox</a></li><li><a href="LevelCreator.html">LevelCreator</a></li><li><a href="Player.html">Player</a></li><li><a href="PlayerLobby.html">PlayerLobby</a></li><li><a href="PlayerMeta.html">PlayerMeta</a></li><li><a href="Projectile.html">Projectile</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Fri Dec 21 2018 10:46:52 GMT+0100 (GMT+01:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
